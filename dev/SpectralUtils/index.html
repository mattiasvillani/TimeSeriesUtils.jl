<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Spectral utilities · TimeSeriesUtils.jl</title><meta name="title" content="Spectral utilities · TimeSeriesUtils.jl"/><meta property="og:title" content="Spectral utilities · TimeSeriesUtils.jl"/><meta property="twitter:title" content="Spectral utilities · TimeSeriesUtils.jl"/><meta name="description" content="Documentation for TimeSeriesUtils.jl."/><meta property="og:description" content="Documentation for TimeSeriesUtils.jl."/><meta property="twitter:description" content="Documentation for TimeSeriesUtils.jl."/><meta property="og:url" content="https://mattiasvillani.github.io/TimeSeriesUtils.jl/SpectralUtils/"/><meta property="twitter:url" content="https://mattiasvillani.github.io/TimeSeriesUtils.jl/SpectralUtils/"/><link rel="canonical" href="https://mattiasvillani.github.io/TimeSeriesUtils.jl/SpectralUtils/"/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../"><img src="../assets/logo.png" alt="TimeSeriesUtils.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../">TimeSeriesUtils.jl</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../ARIMAUtils/">ARIMA utilities</a></li><li class="is-active"><a class="tocitem" href>Spectral utilities</a></li><li><a class="tocitem" href="../GeneralUtils/">General utilities</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Spectral utilities</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Spectral utilities</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/mattiasvillani/TimeSeriesUtils.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/mattiasvillani/TimeSeriesUtils.jl/blob/main/docs/src/SpectralUtils.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><article><details class="docstring" open="true"><summary id="TimeSeriesUtils.spectrum"><a class="docstring-binding" href="#TimeSeriesUtils.spectrum"><code>TimeSeriesUtils.spectrum</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">spectrum(X; method = &quot;pgram&quot;, plot = false)</code></pre><p>R function estimates a spectral density using smoothed periodogram or fitted AR and plots it in R if <code>plot</code> is <code>true</code>.</p><blockquote><p>The spectrum is defined with scaling 1/frequency(x). This makes the spectral density a density over the range (-frequency(x)/2, +frequency(x)/2] [R documentation]</p></blockquote><p><code>method</code> can be <code>&quot;pgram&quot;</code> or <code>&quot;ar&quot;</code>`. returns a dict with keys including</p><ul><li>:freq (vector with linear frequencies between 0 and π)</li><li>:spec (vector with the spectral density estimate)</li></ul><p>Examples:</p><pre><code class="language- hljs">julia&gt; X = rand(Normal(),100);
julia&gt; spectrum(X; method = &quot;pgram&quot;)
OrderedCollections.OrderedDict{Symbol, Any} with 16 entries:
  :freq      =&gt; [0.01, 0.02, 0.03, 0.04, 0.05, 0.06, 0.07, 0.08, 0.09, 0.1  …  0.41, 0.42, 0.43, 0.…
  :spec      =&gt; [0.0162793, 0.391037, 0.0750275, 1.10354, 0.170123, 0.379539, 0.640757, 3.54369, 0.…
  :coh       =&gt; nothing
  :phase     =&gt; nothing
  :kernel    =&gt; nothing
  :df        =&gt; 1.79159
  :bandwidth =&gt; 0.00288675
  :n_used    =&gt; 100
  ⋮          =&gt; ⋮</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mattiasvillani/TimeSeriesUtils.jl/blob/94455d75db9116771f4e770c4442ad2b55e25a7c/src/SpectralUtils.jl#L2-L29">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimeSeriesUtils.pspectrum"><a class="docstring-binding" href="#TimeSeriesUtils.pspectrum"><code>TimeSeriesUtils.pspectrum</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">pspectrum(X; sampfreq = 1, niter = 3, plotflag = false)</code></pre><p>R function multi-taper estimate of the spectral density.</p><p>Examples:</p><pre><code class="language- hljs">julia&gt; X = randn(100);
julia&gt; pspectrum(X)
⋮
OrderedCollections.OrderedDict{Symbol, Any} with 22 entries:
  :freq      =&gt; [0.0, 0.0102041, 0.0204082, 0.0306122, 0.0408163, 0.0510204, 0.0612245, 0.0714286, 0.0816327, 0.0918367  …  0.408163, 0.418367, 0.428571, 0.438776, 0.44898, 0.459184, 0.469388, 0.479592, 0.489796, 0.5]
  :spec      =&gt; [0.175972, 0.175629, 0.175015, 0.173849, 0.17223, 0.171751, 0.171284, 0.170648, 0.172062, 0.173692  …  0.235946, 0.235948, 0.236749, 0.238585, 0.239633, 0.240635, 0.241796, 0.242778, 0.244478, 0.245774]
  :pspec     =&gt; nothing
  :transfer  =&gt; nothing
  :coh       =&gt; nothing
  :phase     =&gt; nothing
  :kernel    =&gt; nothing
  :df        =&gt; 100.0
  :numfreq   =&gt; 50
  :bandwidth =&gt; 1.02
  ⋮          =&gt; ⋮</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mattiasvillani/TimeSeriesUtils.jl/blob/94455d75db9116771f4e770c4442ad2b55e25a7c/src/SpectralUtils.jl#L40-L63">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimeSeriesUtils.pgram"><a class="docstring-binding" href="#TimeSeriesUtils.pgram"><code>TimeSeriesUtils.pgram</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">pGram, ωFourier = pgram(X)</code></pre><p>Computes the periodogram <code>pGram</code> at the <code>ωFourier</code> frequencies for each of the columns in <code>X</code>.</p><p>If X is vector, the returned periodogram <code>pGram</code> is a vector with length(ωFourier) elements.</p><p>If X is a matrix with r&gt;1 columns, the returned periodogram <code>pGram</code> is a 3d array of dimensions (r, r, length(ωFourier)).</p><p>Examples:</p><pre><code class="language-julia-repl hljs">julia&gt; pGram, ωFourier = pgram([1,2,5,8,5])
([14.03746598070517, 2.399901258445937, 0.05108486516925192], [0.0, 1.2566370614359172, 2.5132741228718345])
julia&gt; pGram, ωFourier = pgram([1 3;2 5;5 7;8 4;5 5]); # two column matrix
julia&gt; pGram
2×2×3 Array{Complex, 3}:
[:, :, 1] =
 14.0375+0.0im  16.0428+0.0im
 16.0428+0.0im  18.3346+0.0im

[:, :, 2] =
   2.3999-2.22045e-16im  0.398436-0.825562im
 0.398436+0.825562im     0.350141+0.0im

[:, :, 3] =
  0.0510849+3.46945e-18im  -0.0642101+0.11732im
 -0.0642101-0.11732im        0.350141+0.0im</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mattiasvillani/TimeSeriesUtils.jl/blob/94455d75db9116771f4e770c4442ad2b55e25a7c/src/SpectralUtils.jl#L74-L102">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimeSeriesUtils.pGramDistribution"><a class="docstring-binding" href="#TimeSeriesUtils.pGramDistribution"><code>TimeSeriesUtils.pGramDistribution</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">pGramDistribution(pGram, ωGrid, SpecDens, plotFig)</code></pre><p>Plots the periodogram <code>pGram</code> over the vector of frequencies <code>ωGrid</code> and the exponential distribution implied by the spectral density model <code>SpecDens</code>.</p><p><strong>Examples</strong></p><p>Plot the periodogram and spectral density for the AR(1) model:</p><pre><code class="language-julia-repl hljs">julia&gt; pGram, ωFourier = pgram(simARMA([0.8], [0.0], 0.0, 1.0, 100));
julia&gt; SpecDensDistr = pGramDistribution(pGram[2:end],
    ωFourier[2:end], ω -&gt; SpecDensARMA.(ω, 0.8, 0.0, 1), true);
julia&gt; SpecDensDistr[1] # The implied exponential distribution at ωFourier[2]
Exponential{Float64}(θ=3.6877929014993596)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mattiasvillani/TimeSeriesUtils.jl/blob/94455d75db9116771f4e770c4442ad2b55e25a7c/src/SpectralUtils.jl#L122-L136">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimeSeriesUtils.ℓwhittle"><a class="docstring-binding" href="#TimeSeriesUtils.ℓwhittle"><code>TimeSeriesUtils.ℓwhittle</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">ℓwhittle(pGram::Vector, ω, specDens)</code></pre><p>Compute Whittle approximation to the log-likelihood of a zero mean univariate time series with spectral density <code>specDens</code>. The periodogram data <code>pGram</code> should contain only the strictly positive frequencies.</p><p>The periodogram can be computed with <a href="#TimeSeriesUtils.pgram"><code>pgram</code></a>.</p><p><strong>Examples</strong></p><p>Compute the Whittle log-likelihood of the ARIMA model at the true parameters:</p><pre><code class="language-julia-repl hljs">julia&gt; ϕ = 0.8; θ = 0.0; μ = 0; σ = 1; # Set up data generating AR(1) process.
julia&gt; x = artsim(100, 0, 0, ϕ, θ, μ, σ); # simulate time series of length 100
julia&gt; pGram, ωFourier = pgram(x); # ωFourier are the non-negative Fourier frequencies.
julia&gt; ℓwhittle(pGram[2:end], ωFourier[2:end], ω -&gt; SpecDensARMA.(ω, ϕ, θ, σ^2))
-143.3107687445708 # varies with random seed.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mattiasvillani/TimeSeriesUtils.jl/blob/94455d75db9116771f4e770c4442ad2b55e25a7c/src/SpectralUtils.jl#L156-L173">source</a></section></details></article><article><details class="docstring" open="true"><summary id="TimeSeriesUtils.simProcessSpectral"><a class="docstring-binding" href="#TimeSeriesUtils.simProcessSpectral"><code>TimeSeriesUtils.simProcessSpectral</code></a> — <span class="docstring-category">Function</span></summary><section><div><pre><code class="language-julia hljs">simProcessSpectral(specDens, T, Δₜ)</code></pre><p>Simulates a continuous time process x(t) for t ∈ [0,T] from its (one-sided) spectral density specDens(ω) at time resolution Δₜ.</p><p>Uses FFT as described in Section 5.6 of <a href="https://doi.org/10.1201/b15922">Lindgren et al 2014</a>.</p><p><strong>Examples</strong></p><p>Simulating from a mixture of Gamma spectral density:</p><pre><code class="language-julia-repl hljs">julia&gt; d=Truncated(MixtureModel(Gamma, [(2, 0.1), (150,0.01)]), 0, π);
julia&gt; ωgrid=0.01:0.01:π; p1=plot(ωgrid, 3*pdf.(d,ωgrid), xlab = &quot;v&quot;, ylab = &quot;f(v)&quot;)
julia&gt; T = 10; Δₜ = 0.1; x = simProcessSpectral(ω -&gt; 3*pdf.(d,ω), T, Δₜ);
julia&gt; p2=plot(Δₜ:Δₜ:T, x, xlab = &quot;t&quot;, ylab = &quot;x(t)&quot;)
julia&gt; plot(p1,p2, layout = (2,1), legend = nothing)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mattiasvillani/TimeSeriesUtils.jl/blob/94455d75db9116771f4e770c4442ad2b55e25a7c/src/SpectralUtils.jl#L182-L199">source</a></section><section><div><pre><code class="language-julia hljs">simProcessSpectral(specDens, ωSupport, T, Δₜ [, scale = 1])</code></pre><p>Simulates a continuous time stochastic process x(t) for t ∈ [0,T] at time resolution <code>Δₜ</code> from its (one-sided) discrete spectral density <code>specDens</code> over a vector of frequencies <code>ωSupport</code>. If <code>specDens</code> is a probability density (e.g. from Distributions.jl), then <code>scale</code> is the energy (variance) of the process.</p><p><strong>Examples</strong></p><p>Simulating from a discretized mixture of Gamma spectral density:</p><pre><code class="language-julia-repl hljs">julia&gt; specDens = Truncated(MixtureModel(Gamma, [(2, 0.1), (10, 0.1)]), 0, π);
julia&gt; ωSupport = 0.01:0.25:π; T = 100; Δₜ = 1; scale = 2;
julia&gt; p1 = plot(ωSupport, .√(scale*pdf.(specDens, ωSupport)), xlims = [0,π], 
    seriestype = :sticks, xlab = &quot;v&quot;, ylab = &quot;f(v)&quot;)
julia&gt; x = simProcessSpectral(specDens, ωSupport, T, Δₜ, scale)
julia&gt; p2 = plot(Δₜ:Δₜ:T, x, xlab = &quot;t&quot;, ylab = &quot;x(t)&quot;)
julia&gt; plot(p1, p2, layout = (2,1), legend = nothing)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/mattiasvillani/TimeSeriesUtils.jl/blob/94455d75db9116771f4e770c4442ad2b55e25a7c/src/SpectralUtils.jl#L208-L225">source</a></section></details></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../ARIMAUtils/">« ARIMA utilities</a><a class="docs-footer-nextpage" href="../GeneralUtils/">General utilities »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.16.1 on <span class="colophon-date" title="Tuesday 2 December 2025 14:49">Tuesday 2 December 2025</span>. Using Julia version 1.12.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
